<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğğ¨ğ«ğ­ğšğ¥ ğŠğğ¡ğšğğ¢ğ«ğšğ§ ğŠğğ ğ¢ğšğ­ğšğ§</title>
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<!-- Neon Styles -->
<style>
    body{
        background-color: #0d0d0d;
        color: #ffffff;
        font-family: 'Arial', sans-serif;
    }
    .neon-text{
        color: #ee0707;
        text-shadow:
           0 0 5px #39ff14,
           0 0 10px #39ff14,
           0 0 20px #39ff14,
           0 0 40px #39ff14;
    }
    .neon-card{
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
        cursor: default;
        transition: all 0.4s ease;
        box-shadow: 0 0 15px rgba(255,255,255,0.1);
    }
    .btn-neon{
        background-color: #070707;
        color: #f9f4f4;
        font-weight: bold;
        box-shadow: 0 0 10px #39ff14;
        transition: all 0.3s ease;
    }
    .btn-neon:hover{
        background-color: #0f0;
        color:#000;
    }
    .modal-content{
        background-color: #8807eb;
        color: #fff;
    }
    .clickable{
        text-decoration: underline;
        cursor: pointer;
    }
    .neon-robot{
    font-family: 'Orbitron', sans-serif; /* font robotik futuristik */
    color: #00ffff;
    text-shadow:
      0 0 5px #00ffff,
      0 0 10px #00ffff,
      0 0 20px #00ffff,
      0 0 40px #00ffff;
}
.countdown-container {
  background: rgba(0, 0, 0, 0.6); /* Latar semi-transparan */
  border-radius: 15px;            /* Sudut melengkung */
  box-shadow: 0 0 20px #0ff, 0 0 40px #0ff, 0 0 60px #0ff; /* Efek neon */
  color: #0ff;                    /* Warna teks neon */
}

.neon-glow h1, .neon-glow h3 {
  text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff;
}
.cards-wrapper {
  display: flex;          /* Membuat card sejajar */
  flex-wrap: wrap;        /* Membuat card otomatis ke baris berikutnya jika tidak muat */
  gap: 20px;              /* Jarak antar card */
  justify-content: center; /* Tengah wrapper */
  background: rgba(0,0,0,0.5); /* Latar semi-transparan */
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 0 20px #0ff, 0 0 40px #0ff; /* Efek neon keseluruhan */
}

.neon-card {
  background: rgba(0,0,0,0.7);
  color: #0ff;
  padding: 15px;
  border-radius: 10px;
  text-align: center;
  box-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
  min-width: 200px;       /* Minimal lebar card */
}

</style>
<!-- Tambahkan font Orbitron -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
</head>
<body>
<div class="container py-4">
    <!-- Header -->
    <div class="text-center mb-4">
        <h1 class="neon-text">ğğ¨ğ«ğ­ğšğ¥ ğŠğğ¡ğšğğ¢ğ«ğšğ§ ğğšğ­ğšğ¥ ğğğ«ğ¬ğšğ¦ğš ğ‡ğƒğ’</h1>
        <p id="currentDate"></p>
    </div>
    
<div class="cards-wrapper p-4 my-4">
  <!-- Countdown Timer -->
  <div class="countdown-container p-4 mb-4 text-center neon-glow">
    <h1>ğ–ğšğ¤ğ­ğ® ğŒğ®ğ§ğ£ğ® ğ€ğœğšğ«ğš</h1>
    <h3 id="countdown">00:00:00</h3>
  </div>

  <!-- Semua Card Kampung -->
  <div class="row" id="kampungContainer"></div>
</div>

    <!-- Persentase Total 13 Kampung -->
    <div class="mt-4 text-center">
        <h4 class="neon-text">ğğ„ğ‘ğ’ğ„ğğ“ğ€ğ’ğ„ ğ“ğğ“ğ€ğ‹ ğ‡ğ€ğƒğˆğ‘ ğƒğ€ğ ğ“ğˆğƒğ€ğŠ ğ‡ğ€ğƒğˆğ‘</h4>
        <p>ğ‡ğšğğ¢ğ«: <span id="totalHadir">0</span> | ğ“ğ¢ğğšğ¤ ğ‡ğšğğ¢ğ«: <span id="totalTidakHadir">0</span> | ğğğ«ğ¬ğğ§ğ­ğšğ¬ğ ğ‡ğšğğ¢ğ«: <span id="totalPercent">0%</span></p>
    </div>
</div>

<!-- Modal Form Input Kehadiran -->
<div class="modal fade" id="formModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title neon-text" id="formTitle">ğ…ğ¨ğ«ğ¦ ğŠğğ¡ğšğğ¢ğ«ğšğ§</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="attendanceForm">
          <input type="hidden" id="kampungName">
          <input type="hidden" id="statusType">
          <div class="mb-2">
            <label>ğğ¨:</label>
            <input type="number" class="form-control" id="no" required>
          </div>
          <div class="mb-2">
            <label>ğ“ğšğ§ğ ğ ğšğ¥ ğŠğğ›ğğ«ğšğ§ğ ğ¤ğšğ­ğšğ§:</label>
            <input type="date" class="form-control" id="tanggal" required>
          </div>
          <div class="mb-2">
            <label>ğğšğ¦ğš:</label>
            <input type="text" class="form-control" id="namaOMK" required>
          </div>
          <div class="mb-2">
            <label>ğ€ğ¬ğšğ¥ ğğŒğŠ:</label>
            <input type="text" class="form-control" id="asalOMK" required>
          </div>
          <div class="mb-2" id="alasanDiv" style="display:none;">
            <label>ğ€ğ¥ğšğ¬ğšğ§ ğ“ğ¢ğğšğ¤ ğ‡ğšğğ¢ğ«:</label>
            <input type="text" class="form-control" id="alasanOMK">
          </div>
          <button type="submit" class="btn btn-neon w-100">ğ’ğ¢ğ¦ğ©ğšğ§</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal Rangkuman -->
<div class="modal fade" id="summaryModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title neon-text" id="summaryTitle">ğ‘ğšğ§ğ ğ¤ğ®ğ¦ğšğ§ ğŠğğ¡ğšğğ¢ğ«ğšğ§</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="summaryBody"></div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyAhhc6qoUVPHV-uuo9FZdmDK6vPkaL6OG4",
  authDomain: "dashboard-omk-sawe.firebaseapp.com",
  projectId: "dashboard-omk-sawe",
  storageBucket: "dashboard-omk-sawe.firebasestorage.app",
  messagingSenderId: "622613624050",
  appId: "1:622613624050:web:ab929ed51c6cf2e0d20c6b",
  measurementId: "G-TKWEEHV6XG"
};
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Set current date otomatis
  document.getElementById('currentDate').innerText = "Tanggal: " + new Date().toLocaleDateString();

  const kampungs = [
    "ğ’ğğ¤ğ¨ğ§ğšğ®","ğŒğ¨ğ«ğšğ§","ğ’ğğ ğ¢ğšğ¦ ğ‡ğ®ğ¥ğ®","ğŠğšğ¤ğ¢ ğ‘ğ¢ğšğ¦","ğ‚ğ®ğ¤ğšğ¤ ğ‡ğ¢ğ¥ğ¢ğ«","ğğğ¨ğ§ğ ",
    "ğŠğ®ğ§ğ¬ğ¢ğ­","ğŠğ¢ğšğ­ğšğ¤","ğğšğ§ğ ğš ğğ¢ğšğ›ğšğ§","ğğšğ®","ğğšğ§ğğšğ§","ğ‹ğšğ§ğğšğ¬","ğ†ğğğğ­"
  ];

  const kampungContainer = document.getElementById('kampungContainer');
  const formModal = new bootstrap.Modal(document.getElementById('formModal'));
  const summaryModal = new bootstrap.Modal(document.getElementById('summaryModal'));

  // Form Input
  function openForm(kampung, status){
    document.getElementById('kampungName').value = kampung;
    document.getElementById('statusType').value = status;
    document.getElementById('formTitle').innerText = status === 'hadir' ? 'Form Kehadiran' : 'Form Tidak Hadir';
    document.getElementById('alasanDiv').style.display = status === 'tidakHadir' ? 'block' : 'none';
    formModal.show();
  }

  document.getElementById('attendanceForm').addEventListener('submit', function(e){
    e.preventDefault();
    const kampung = document.getElementById('kampungName').value;
    const status = document.getElementById('statusType').value;
    const no = document.getElementById('no').value;
    const tanggal = document.getElementById('tanggal').value;
    const nama = document.getElementById('namaOMK').value;
    const asal = document.getElementById('asalOMK').value;
    const alasan = document.getElementById('alasanOMK').value || "";

    db.ref('kehadiran/'+kampung).push({no, tanggal, nama, status, alasan});
    formModal.hide();
    this.reset();
  });

  // Update counts per kampung & total
  function updateCounts(kampung){
    db.ref('kehadiran/'+kampung).once('value', snapshot => {
      const data = snapshot.val() || {};
      let hadir = 0, tidakHadir = 0;
      Object.values(data).forEach(item => {
        if(item.status === 'hadir') hadir++;
        else tidakHadir++;
      });
      const total = hadir + tidakHadir;
      document.getElementById(kampung+'-hadir').innerText = hadir;
      document.getElementById(kampung+'-tidakHadir').innerText = tidakHadir;
      document.getElementById(kampung+'-percent').innerText = total > 0 ? Math.round((hadir/total)*100)+'%' : '0%';
      updateTotal();
    });
  }

  // Update total persentase 13 kampung
  function updateTotal(){
    let totalHadir = 0, totalTidakHadir = 0;
    kampungs.forEach(k => {
      const hadir = parseInt(document.getElementById(k+'-hadir').innerText);
      const tidakHadir = parseInt(document.getElementById(k+'-tidakHadir').innerText);
      totalHadir += hadir;
      totalTidakHadir += tidakHadir;
    });
    const total = totalHadir + totalTidakHadir;
    document.getElementById('totalHadir').innerText = totalHadir;
    document.getElementById('totalTidakHadir').innerText = totalTidakHadir;
    document.getElementById('totalPercent').innerText = total > 0 ? Math.round((totalHadir/total)*100)+'%' : '0%';
  }

  // Show rangkuman per kampung saat teks di klik
  function showSummary(kampung){
    db.ref('kehadiran/'+kampung).once('value', snapshot => {
      const data = snapshot.val() || {};
      let hadirList = "", tidakHadirList = "";
      Object.values(data).forEach(item => {
        if(item.status === 'hadir'){
          hadirList += `<li>${item.no}. ${item.nama} - ${item.tanggal}</li>`;
        } else {
          tidakHadirList += `<li>${item.no}. ${item.nama} - ${item.tanggal} | Alasan: ${item.alasan}</li>`;
        }
      });
      document.getElementById('summaryTitle').innerText = "Rangkuman - " + kampung;
      document.getElementById('summaryBody').innerHTML = `
        <h5>Hadir</h5><ul>${hadirList || '<li>Belum ada yang hadir</li>'}</ul>
        <h5 class="mt-3">Tidak Hadir</h5><ul>${tidakHadirList || '<li>Semua hadir</li>'}</ul>
      `;
      summaryModal.show();
    });
  }

  // Listen realtime untuk semua kampung
  kampungs.forEach(k => {
    db.ref('kehadiran/'+k).on('value', snapshot => updateCounts(k));
  });
const cardColors = [
  "#1abc9c","#e67e22","#9b59b6","#f1c40f","#3498db","#e74c3c",
  "#2ecc71","#f39c12","#8e44ad","#d35400","#2980b9","#c0392b","#16a085"
];

kampungs.forEach((k, index) => {
  const col = document.createElement('div');
  col.className = "col-md-4 col-sm-6";
  const bgColor = cardColors[index % cardColors.length]; // pilih warna berbeda
  col.innerHTML = `
    <div class="neon-card" style="background-color: ${bgColor}; box-shadow: 0 0 15px ${bgColor};">
      <h5 class="neon-text">${k}</h5>
      <p class="clickable" onclick="showSummary('${k}')">ğŠğğ¡ğšğğ¢ğ«ğšğ§: <span id="${k}-hadir">0</span> | ğ“ğ¢ğğšğ¤ ğ‡ğšğğ¢ğ«: <span id="${k}-tidakHadir">0</span></p>
      <p>ğğğ«ğ¬ğğ§ğ­ğšğ¬ğ: <span id="${k}-percent">0%</span></p>
      <div class="d-flex justify-content-between mt-2">
        <button class="btn btn-neon" onclick="openForm('${k}','hadir')">Hadir</button>
        <button class="btn btn-neon" onclick="openForm('${k}','tidakHadir')">Tidak Hadir</button>
      </div>
    </div>
  `;
  kampungContainer.appendChild(col);
});

// Set tanggal acara
const eventDate = new Date("2025-12-28T00:00:00"); // format: YYYY-MM-DDTHH:MM:SS

function updateCountdown(){
    const now = new Date();
    let diff = eventDate - now;

    if(diff < 0){
        document.getElementById('countdown').innerText = "Acara Dimulai!";
        clearInterval(countdownInterval);
        return;
    }

    const hours = Math.floor(diff / (1000*60*60));
    const minutes = Math.floor((diff % (1000*60*60)) / (1000*60));
    const seconds = Math.floor((diff % (1000*60)) / 1000);

    document.getElementById('countdown').innerText =
      `${hours.toString().padStart(2,'0')}:${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
}

const countdownInterval = setInterval(updateCountdown, 1000);
updateCountdown();

</script>
</body>
</html>
